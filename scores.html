<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
      h1 {
      margin-right: auto;
      margin-left: auto;
      width: 200px;
      }
     h2 {
      margin-right: auto;
      margin-left: auto;
      width: 200px;
     }
     a {
      margin-right: auto;
      margin-left: auto;
      width: 200px;
     }
      
    </style>
</head>
<body>
    <h1>Game Over!</h1>
    <div id="player_score"></div>
    <a href="index.html">Play Again?</a>
    <h2>Scores</h2>
    <div id="scores">
      <table id="score-table">
        <tr class="score-table-header">
          <td>
            Initials
          </td>
          <td>
            Time
          </td>
          <td>
            Score
          </td>
        </tr>
      </table>
    </div>
    <hr>
    <script>

        console.log(localStorage.getItem('js_quiz_current'))

        // display the current users results
        var data = JSON.parse(localStorage.getItem('js_quiz_current'));
        document.querySelector("#player_score").innerHTML = `You got ${data["score"]} correct within ${data["time"]} seconds.`;

        // ask the user for their initials
        var initials = prompt("What are your initials?");

        // create the score object
        var score = {"time": data["time"], "score": data["score"], "initials": initials};

        var all_time_scores;

        // save the current quiz score to the permanent quiz scores
        if (localStorage.getItem('js_quiz_scores')){
          // parse the js_quiz_scores
          all_time_scores = JSON.parse(localStorage.getItem('js_quiz_scores'));

          // add the score object to the js_quiz_scores array
          all_time_scores.push(score);

        }
        else {

          // save the score object to an array within all_time_scorse
          all_time_scores = [score];

        }

        // save the js_quiz_scores object
        localStorage.setItem('js_quiz_scores', JSON.stringify(all_time_scores));
        
        // clear the current js_quiz_current loacl storage 
        localStorage.setItem('js_quiz_current', "");

        // grab the scores div
        var scores = document.querySelector("#scores");
        
        // render the scores to the user
        for (i=0; i < all_time_scores.length; i++){

          var table = document.getElementById("score-table");

          // Create an empty <tr> element
          var row = table.insertRow();

          // Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
          var initials_cell = row.insertCell(0);
          var time_cell = row.insertCell(1);
          var score_cell = row.insertCell(2);

          // Add some text to the new cells:
          initials_cell.innerHTML = all_time_scores[i]["initials"];
          time_cell.innerHTML = all_time_scores[i]["time"];
          score_cell.innerHTML = all_time_scores[i]["score"];
          
        }


    </script>
</body>
</html>